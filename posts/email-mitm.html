<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Two Look-Alike Domains. One Email Man-in-the-Middle.</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700&family=Source+Serif+4:ital,wght@0,300;0,400;0,600;1,300;1,400&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --ink: #1a1a1a;
    --ink-light: #4a4a4a;
    --ink-muted: #888;
    --rule: #d4d0c8;
    --code-bg: #f5f4f0;
    --code-border: #e0ddd5;
    --accent: #c0392b;
    --page: #faf9f6;
    --max: 740px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--page);
    color: var(--ink);
    font-family: 'Source Serif 4', Georgia, serif;
    font-size: 18px;
    line-height: 1.75;
    font-weight: 300;
  }

  .page {
    max-width: var(--max);
    margin: 0 auto;
    padding: 80px 40px 120px;
  }

  /* ── Header ── */
  .masthead {
    border-top: 3px solid var(--ink);
    border-bottom: 1px solid var(--ink);
    padding: 32px 0 28px;
    margin-bottom: 56px;
  }

  .kicker {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 20px;
  }

  h1 {
    font-family: 'Playfair Display', Georgia, serif;
    font-size: clamp(28px, 5vw, 42px);
    font-weight: 900;
    line-height: 1.15;
    color: var(--ink);
    letter-spacing: -0.02em;
  }

  .deck {
    margin-top: 20px;
    font-size: 18px;
    font-style: italic;
    color: var(--ink-light);
    line-height: 1.6;
    font-weight: 300;
    border-left: 2px solid var(--accent);
    padding-left: 16px;
  }

  /* ── Section headings ── */
  h2 {
    font-family: 'Playfair Display', Georgia, serif;
    font-size: 24px;
    font-weight: 700;
    margin: 56px 0 16px;
    color: var(--ink);
    padding-bottom: 10px;
    border-bottom: 1px solid var(--rule);
  }

  h3 {
    font-family: 'Source Serif 4', Georgia, serif;
    font-size: 17px;
    font-weight: 600;
    margin: 36px 0 12px;
    color: var(--ink);
    text-transform: uppercase;
    letter-spacing: 0.06em;
    font-style: normal;
  }

  /* ── Body text ── */
  p {
    margin-bottom: 20px;
    color: var(--ink);
  }

  p strong {
    font-weight: 600;
    color: var(--ink);
  }

  p em {
    font-style: italic;
    color: var(--ink-light);
  }

  code {
    font-family: 'JetBrains Mono', monospace;
    font-size: 14px;
    background: var(--code-bg);
    padding: 1px 5px;
    border-radius: 3px;
    color: var(--accent);
  }

  /* ── Code blocks ── */
  pre {
    background: var(--code-bg);
    border: 1px solid var(--code-border);
    border-left: 3px solid var(--ink-muted);
    padding: 20px 24px;
    margin: 24px 0;
    overflow-x: auto;
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    line-height: 1.65;
    color: var(--ink);
  }

  /* ── Rule ── */
  hr {
    border: none;
    border-top: 1px solid var(--rule);
    margin: 48px 0;
  }

  /* ── Lists ── */
  ul {
    margin: 16px 0 20px 0;
    padding-left: 20px;
  }

  ul li {
    margin-bottom: 8px;
    padding-left: 6px;
  }

  /* ── Callout / pull quote ── */
  .callout {
    border-left: 3px solid var(--accent);
    margin: 32px 0;
    padding: 16px 20px;
    background: #fdf5f4;
  }

  .callout p {
    margin: 0;
    font-size: 17px;
    color: var(--ink);
    font-weight: 400;
  }

  /* ── Disclaimer ── */
  .disclaimer {
    margin-top: 64px;
    padding-top: 24px;
    border-top: 1px solid var(--rule);
    font-size: 14px;
    color: var(--ink-muted);
    font-style: italic;
    text-align: center;
  }

  /* ── Indicator labels ── */
  .indicator-label {
    display: inline-block;
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    background: var(--ink);
    color: var(--page);
    padding: 3px 8px;
    margin-bottom: 10px;
  }

  @media (max-width: 600px) {
    .page { padding: 40px 20px 80px; }
    pre { font-size: 12px; padding: 16px; }
  }
</style>
</head>
<style>
  .site-nav {
    border-bottom: 1px solid var(--rule);
    padding: 20px 40px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: 820px;
    margin: 0 auto;
  }
  .site-nav a {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--ink-muted);
    text-decoration: none;
  }
  .site-nav a:hover { color: var(--accent); }
  .site-nav .logo { color: var(--ink); }
  @media (max-width: 600px) { .site-nav { padding: 16px 20px; } }
</style>
<body>
<nav class="site-nav">
  <a href="/" class="logo">AD · Cloud Security</a>
  <a href="/">← All Posts</a>
</nav>
<div class="page">

  <div class="masthead">
    <div class="kicker">Email Security &nbsp;·&nbsp; Incident Analysis &nbsp;·&nbsp; Detection Engineering</div>
    <h1>Two Look-Alike Domains. One Email Man-in-the-Middle. Nobody Noticed Until It Was Too Late.</h1>
    <p class="deck">By the time security was engaged, there was no malware to sandbox, no credential to reset, no exploit to reverse. There was just an email thread — professional, multi-participant, entirely normal — and a business decision made in good faith that should never have been made at all.</p>
  </div>

  <p>This analysis reflects patterns observed in a real-world BEC investigation. Technical artifacts illustrate actual attack methodology. All identifying details have been anonymized. The lessons aren't.</p>

  <hr>

  <h2>The Setup: Why It Worked Before Anyone Noticed</h2>
  <p>The attacker didn't compromise anything. They registered a domain.</p>
  <p><strong>Legitimate domain:</strong> <code>meridianpay.com</code><br>
  <strong>Attacker domain:</strong> <code>meridiapay.com</code></p>
  <p>The letter "n" dropped from "meridian" — turning "Meridian Pay" into "Meridia Pay." Both read as plausible company names at a glance. That is the entire attack surface, and it is enough.</p>
  <p>What makes this particularly dangerous is what happened next. The attacker didn't just register a lookalike domain — they configured it identically to legitimate vendor infrastructure. Same MX provider. Valid SPF. Valid DKIM. No DMARC — matching the vendor exactly.</p>
  <p>When the phishing emails arrived, every authentication check returned green.</p>

  <hr>

  <h2>The Full Picture: This Wasn't One-Sided</h2>
  <p>Here is where the attack becomes significantly more sophisticated than a standard BEC.</p>
  <p>Most people assume BEC works like this: attacker impersonates a vendor, victim is deceived, damage is done. One deception, one victim.</p>
  <p>This attack ran two deceptions simultaneously.</p>
  <p><strong>The attacker registered two domains:</strong></p>

<pre>Attacker domain 1:   meridiapay.com     ← impersonates the vendor
                     (deceives Pinnacle Corp into thinking it's the real vendor)

Attacker domain 2:   pinnaclecorp.com   ← impersonates the victim company
                     (deceives Meridian Pay into thinking it's Pinnacle Corp)</pre>

  <p>The vendor wasn't silent. They were actively communicating — just not with Pinnacle Corp. Meridian Pay's replies were going to <code>pinnaclecorp.com</code>, an attacker-controlled inbox. Pinnacle Corp's emails were going to <code>meridiapay.com</code>, another attacker-controlled inbox.</p>
  <p>The attacker sat in the middle of both conversations, reading everything, forwarding selectively, controlling the narrative from both ends.</p>

<pre>Reality of the communication flow:

PINNACLE CORP  → meridiapay.com (attacker) → MERIDIAN PAY NEVER RECEIVED IT
MERIDIAN PAY  → pinnaclecorp.com (attacker) → PINNACLE CORP NEVER RECEIVED IT

What both sides thought was happening:
PINNACLE CORP  ←────────────────────────────→ MERIDIAN PAY</pre>

  <p>This means:</p>
  <ul>
    <li>Meridian Pay believed they were in active communication with Pinnacle Corp — they were not</li>
    <li>Pinnacle Corp believed it was in active communication with Meridian Pay — it was not</li>
    <li>Every reply, every clarification, every update passed through attacker-controlled infrastructure</li>
    <li>Neither side had any reason to suspect a problem because responses kept coming</li>
  </ul>

  <p>In attacks of this nature, the real vendor has no awareness that their identity is being used — the impersonation operates entirely outside their infrastructure. Their legitimate responses go to the attacker, not the intended recipient, and they have no visibility into what is happening on either side.</p>

  <div class="callout">
    <p><strong>This is not phishing. This is a full email man-in-the-middle operation.</strong></p>
  </div>

  <p>The attacker didn't need to forge anything, compromise any account, or intercept any traffic. They just controlled the addressing on both sides and let normal human communication do the rest.</p>

  <hr>

  <h2>The Technical Evidence</h2>

  <h3>Header Analysis: Why Every Gate Passed</h3>

<pre>Return-Path: &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7a1813161613141d3a171f08131e131b0a1b0354191517">[email&#160;protected]</a>&gt;
Received: from mail.meridiapay.com (198.51.100.47)
DKIM-Signature: v=1; a=rsa-sha256; d=meridiapay.com
Authentication-Results:
  spf=pass (meridiapay.com: 198.51.100.47 is authorized)
  dkim=pass header.d=meridiapay.com
  dmarc=pass action=none header.from=meridiapay.com</pre>

  <p>Everything passed. Because everything <em>was</em> valid — for the attacker's domain.</p>
  <p>This is the part most people miss: SPF, DKIM, and DMARC validate <strong>sending infrastructure</strong>. They don't validate whether a domain should be trusted by the receiving organization.</p>

  <h3>Infrastructure Comparison</h3>

<pre>Legitimate domain:     meridianpay.com
  Registrar:           Major registrar
  Created:             Early 2000s
  MX:                  cloud-based mail routing infrastructure
  SPF:                 v=spf1 include:[cloud-mail-provider] ~all
  DMARC:               Not configured

Attacker domain:       meridiapay.com
  Registrar:           Privacy-protected
  Created:             Several months before the attack
  MX:                  cloud-based mail routing infrastructure
  SPF:                 v=spf1 include:[cloud-mail-provider] ~all
  DMARC:               Not configured</pre>

  <p>The attacker mirrored the legitimate mail infrastructure deliberately. Same MX provider, same configuration pattern. To a recipient's mail server — and to most email gateways — the two domains looked operationally identical.</p>
  <p>The attacker registered the domain months in advance. This wasn't opportunistic. It was planned.</p>

  <h3>Thread Reconstruction via Message-ID</h3>

<pre>Message 1:   From: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ff9c90918b9e9c8bbf929a8d969b969e918f9e86d19c9092">[email&#160;protected]</a>           ← real vendor
             Message-ID: &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1253222223527f77607b767b737c62736b3c717d7f">[email&#160;protected]</a>&gt;

Message 2:   From: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="731a1d0716011d121f5e0600160133031a1d12101f16101c01035d101c1e">[email&#160;protected]</a>     ← internal reply
             In-Reply-To: &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e4a5d4d4d5a48981968d808d858a94859dca878b89">[email&#160;protected]</a>&gt;

Message 3:   From: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="91f3f8fdfdf8fff6d1fcf4e3f8f5f8f0e1f0e8bff2fefc">[email&#160;protected]</a>            ← attacker enters here
             In-Reply-To: &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3273020203725f57405b565b535c42534b1c515d5f">[email&#160;protected]</a>&gt;     ← correctly references real thread</pre>

  <p>The attacker entered mid-thread. They demonstrated clear awareness of the active conversation and inserted themselves at a point where context and trust between participants had already been established. Once in the thread, they were indistinguishable from a legitimate participant.</p>

  <hr>

  <h2>What the Security Stack Saw</h2>
  <p>The organization had a standard enterprise security posture — email gateway, SIEM, MFA, EDR. Here is exactly what each control observed:</p>

<pre>Email Gateway:
  SPF check           → PASS  (valid for meridiapay.com)
  DKIM verification   → PASS  (valid signature for meridiapay.com)
  DMARC policy        → PASS  (no DMARC on attacker domain = no enforcement)
  Malware scan        → CLEAN (no payload, no URLs, plain text)
  Attachment sandbox  → N/A   (no attachments)

SIEM:
  Authentication anomalies   → None
  Endpoint alerts            → None
  Lateral movement           → None

What happened:             Successful impersonation. Serious operational impact.</pre>

  <p>None of the controls failed. They performed exactly as designed. The attack succeeded in the gap between what email authentication validates and what business trust actually requires.</p>

  <h3>The DMARC Gap (Commonly Misunderstood)</h3>
  <p>Neither the legitimate vendor domain nor the attacker's lookalike had DMARC configured:</p>

<pre>meridianpay.com:   _dmarc → No record (NXDOMAIN response)
meridiapay.com:    _dmarc → No record (NXDOMAIN response)</pre>

  <p>This is a critical gap, but it is also commonly misunderstood — even if the vendor had DMARC published at <code>p=reject</code>, it would not have stopped this attack.</p>
  <p>DMARC protects against spoofing of a specific domain. When an attacker registers a completely separate domain (<code>meridiapay.com</code>) and configures their own mail infrastructure for it, DMARC on <code>meridianpay.com</code> is irrelevant. The attacker is not spoofing the vendor — they are operating their own domain with its own valid authentication.</p>
  <p>The absence of DMARC on the legitimate vendor domain made the two domains look symmetrically configured to a recipient's mail system — neither enforcing, neither rejecting, both appearing equally "normal." That symmetry made the switch harder to detect.</p>

  <div class="callout">
    <p><strong>DMARC is a spoofing defense. It is not a lookalike domain defense. These are different threat vectors requiring different controls.</strong></p>
  </div>

  <hr>

  <h2>Behavioral IOCs: What Traditional Tools Miss</h2>
  <p>BEC has no classic IOCs. There are no hashes, no malicious URLs, no exploit signatures. Detection requires pattern analysis against business context — which most security tools don't have.</p>

<pre>Behavioral Indicators Missed:
├── DOMAIN_SIMILARITY      sender closely resembles known vendor domain
│                          (letter omission: meridianpay.com → meridiapay.com)
├── DOMAIN_AGE             meridiapay.com registered several months prior
├── FIRST_TIME_SENDER      no prior mail history from this domain
├── MID_THREAD_ENTRY       new external participant joins active thread
├── FINANCIAL_REQUEST      payment/banking keywords present
├── ACCOUNT_CHANGE         request to update payment information
└── FINANCE_TARGET         recipient in a finance-adjacent role</pre>

  <p>None of these triggered because none of them were being monitored. The gateway was checking for threats. It wasn't checking for business context anomalies.</p>

  <hr>

  <h2>Detection Engineering: SIEM Rules That Would Have Caught This</h2>
  <p>These rules target the behavioral gaps that allowed the attack to succeed:</p>

<pre>Rule 1: Lookalike Domain — First Contact
─────────────────────────────────────────
IF:
  sender_domain ~= known_vendor_domain (Levenshtein distance ≤ 2)
  AND sender_domain != known_vendor_domain
  AND domain_age(sender_domain) &lt; 180 days
  AND no prior mail history from sender
THEN:
  Severity: Medium
  Action: Tag + notify security team

Rule 2: External Participant Joins Financial Thread
─────────────────────────────────────────
IF:
  new external address added to existing thread
  AND thread_age &gt; 48 hours
  AND message contains [invoice | payment | wire | banking | transfer]
  AND sender NOT IN verified_vendor_contacts
THEN:
  Severity: High
  Action: Hold for review + alert

Rule 3: Payment Detail Change Request
─────────────────────────────────────────
IF:
  sender is external
  AND message contains [account number | routing | IBAN | bank details]
  AND keywords: [updated | new | changed] + [banking | payment | wire]
  AND recipient is in [finance | treasury | payments]
THEN:
  Severity: Critical
  Action: Quarantine + mandatory out-of-band verification</pre>

  <hr>

  <h2>IR Checklist: Investigating a Suspected BEC</h2>

<pre>PHASE 1 — TRIAGE
☐ Extract full headers from all messages in thread (not display view)
☐ Identify all sending domains — compare against known vendor list
☐ Check domain registration date (WHOIS)
☐ Verify MX, SPF, DKIM, DMARC on attacker domain
☐ Confirm domain ownership — is this registered by the vendor?

PHASE 2 — TIMELINE RECONSTRUCTION
☐ Extract Message-ID and In-Reply-To from every message
☐ Map when each external participant joined the thread
☐ Identify exact point of attacker entry
☐ Document all financial requests: amounts, account details, timing

PHASE 3 — SCOPE ASSESSMENT
☐ Search email logs for other recipients of attacker domain
☐ Check for other lookalike domains in recent mail history
☐ Verify all pending payments — are any sent to attacker accounts?
☐ Contact legitimate vendor via verified phone (not email)

PHASE 4 — CONTAINMENT
☐ Block attacker domain at email gateway
☐ Preserve all evidence (headers, logs, screenshots)
☐ If financial action was taken: engage finance and legal for remediation
☐ Notify affected teams

PHASE 5 — ROOT CAUSE
☐ Which controls failed to detect the entry point?
☐ What business process allowed the change without verification?
☐ Document gaps for corrective action</pre>

  <hr>

  <h2>What the Investigation Revealed</h2>
  <p>Beyond the domain infrastructure analysis, the investigation surfaced several findings that explain why the attack succeeded at multiple layers simultaneously.</p>

  <div class="indicator-label">Indicator 1</div>
  <h3>Free Email Provider Used in Attack Chain</h3>
  <p>Analysis of the email headers revealed that at least one message in the attack chain originated from a free consumer email provider rather than the attacker's registered lookalike domain.</p>

<pre>Expected:   <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c1a3a8adada8afa681aca4b3a8a5a8a0b1a0b8efa2aeac">[email&#160;protected]</a>     ← registered lookalike domain
Observed:   [attacker]@freemail.com    ← free consumer provider, no corporate infrastructure</pre>

  <p>A sender using a free email provider for what is framed as a corporate financial communication is a clear anomaly. Free provider addresses in financial communication threads involving payment changes should be treated as an automatic escalation trigger.</p>

  <div class="indicator-label">Indicator 2</div>
  <h3>Email Client Security Warnings Were Present but Ignored</h3>
  <p>The email client displayed security warnings on messages arriving from the unverified sender. These warnings were visible to the recipient and were not acted upon.</p>
  <p>When a warning is surfaced and dismissed without escalation, the technical control has functioned correctly. The process control has failed.</p>
  <div class="callout"><p><strong>The warning fired. The workflow did not have a step for what to do next.</strong></p></div>

  <div class="indicator-label">Indicator 3</div>
  <h3>Side-by-Side Technical Comparison of Vendor vs. Attacker Domain</h3>

<pre>WHOIS COMPARISON
─────────────────────────────────────────────────────────
                        meridianpay.com      meridiapay.com
                        (legitimate)         (attacker)
─────────────────────────────────────────────────────────
Created:                Early 2000s          Recent registration
Registrar:              Established provider Major registrar
Privacy:                Standard             Fully redacted
Registration length:    10+ years            1 year
Nameservers:            Legacy provider NS   Cloud-based DNS
DNSSEC:                 Unsigned             Unsigned
─────────────────────────────────────────────────────────

MX RECORDS
─────────────────────────────────────────────────────────
meridianpay.com:        mx001.[provider].net
                        mx002.[provider].net

meridiapay.com:         cloud-based mail routing infrastructure
─────────────────────────────────────────────────────────

SPF RECORDS
─────────────────────────────────────────────────────────
meridianpay.com:        v=spf1 include:[legacy-mail-provider] ~all
meridiapay.com:         v=spf1 include:[cloud-mail-provider] ~all
─────────────────────────────────────────────────────────

DMARC
─────────────────────────────────────────────────────────
meridianpay.com:        NOT CONFIGURED
meridiapay.com:         NOT CONFIGURED (NXDOMAIN)
─────────────────────────────────────────────────────────

A RECORD (web hosting)
─────────────────────────────────────────────────────────
meridianpay.com:        No A record (not web-hosted)
meridiapay.com:         Resolves to commodity shared hosting infrastructure
─────────────────────────────────────────────────────────</pre>

  <p>The legitimate vendor domain is a long-established stable domain using a long-standing mail provider — exactly what you would expect from an established business. No web presence, legacy mail infrastructure, continuously registered for decades.</p>
  <p>The attacker domain was registered months before the attack, fully privacy-protected, on a 1-year term. Immediately configured with cloud-based mail infrastructure. Resolved to a commodity shared hosting IP with no history. No DMARC.</p>
  <p><strong>Neither domain had DMARC configured.</strong> This created a technical trust vacuum — receiving mail servers had no policy enforcement to reference for either domain. The attacker deliberately mirrored this gap.</p>
  <p><strong>Vendor email authentication posture is part of an organization's attack surface.</strong> A vendor without DMARC cannot protect against impersonation of their own domain — and that weakness extends to every organization that trusts them financially.</p>

  <div class="indicator-label">Indicator 4</div>
  <h3>Human Factors</h3>
  <p>The investigation identified three human factor failures that operated independently of technical controls:</p>
  <p>Recipients trusted visually similar lookalike domains without verifying the sender address. The difference between <code>meridianpay.com</code> and <code>meridiapay.com</code> was not noticed during an active email thread where trust had already been established.</p>
  <p>No out-of-band verification was performed when payment-related details were introduced mid-thread. The request arrived in the context of an ongoing conversation, which reduced the perception of risk.</p>
  <p>The attacker deliberately exploited a long-running, trust-based communication thread. Duration and familiarity of a vendor relationship can lower scrutiny — which is exactly the condition the attacker selected for.</p>

  <hr>

  <h2>The Attack Campaign Fingerprint</h2>
  <p>One detail from the investigation deserves its own focus because it is the clearest proof that this was not opportunistic — it was planned.</p>
  <p>Both attacker-controlled domains were registered within a <strong>short window</strong> of each other, well before the attack was executed.</p>

<pre>Domain registration timeline:

meridiapay.com      ← impersonates vendor
  Registered:       Weeks before the attack
  Configured:       Cloud mail infrastructure + SPF active immediately
  Purpose:          Deceive Pinnacle Corp

pinnaclecorp.com    ← impersonates victim organization
  Registered:       Within the same short window
  Configured:       Cloud-based mail infrastructure
  Purpose:          Deceive Meridian Pay

Time between registration and attack execution: short window</pre>

  <p>The sequencing strongly suggests prior awareness of the vendor relationship. Registering a lookalike of a specific vendor — rather than a generic target — implies the financial relationship was known before the first domain was purchased.</p>
  <p>The attack required a reconnaissance phase. Someone monitored communication patterns, identified the financial relationship, identified both domain names, and registered lookalikes of both before making contact.</p>
  <p>The 1-year registration on both attacker domains is consistent with a single campaign — enough time to execute the fraud and abandon the infrastructure. Not a long-term operation; a targeted strike.</p>
  <p>Both domains using identical mail infrastructure suggests a single operator running a repeatable playbook. The configuration choices — major registrar, cloud-based MX, privacy protection, SPF with softfail, no DMARC — are not coincidental. They are a template.</p>

  <div class="callout">
    <p><strong>This is the difference between phishing and targeted fraud.</strong> Phishing is volume-based and opportunistic. What happened here was researched, prepared, and executed with specific knowledge of the target organization's vendor relationships. The infrastructure was built before the first email was sent.</p>
  </div>

  <hr>

  <h2>The Authentication Posture Problem</h2>
  <p>After the incident, a full authentication review surfaced a gap that made this partially possible from the legitimate domain's side as well.</p>
  <p>The organization's DMARC enforcement had not reached <code>p=reject</code>. Combined with no aggregate reporting configured, the team had no visibility into spoof attempts against their domain and no maximum enforcement in place. Moving to full rejection with reporting enabled addressed both gaps.</p>
  <p>This doesn't stop lookalike domain attacks. But it eliminates direct spoofing of the primary domain and, critically, gives security teams visibility into who is attempting to abuse it.</p>
  <p>The SPF record had multiple authorized senders — cloud mail, marketing platforms, CRM tools — which is operationally common in modern enterprises but requires careful alignment validation before enforcing <code>p=reject</code>. Moving too fast breaks legitimate mail. Validate each sender's DKIM alignment first.</p>

  <hr>

  <h2>Key Observations</h2>

  <p><strong>1. Authentication ≠ Trust</strong><br>
  Every email authentication protocol (SPF, DKIM, DMARC) passed on the attacker's domain. These protocols validate infrastructure legitimacy, not organizational trust. A domain registered yesterday with perfect authentication is indistinguishable from a vendor the organization has worked with for five years — at the protocol level.</p>

  <p><strong>2. This Was a Double Impersonation, Not a Single One</strong><br>
  The attacker didn't just impersonate the vendor to deceive Pinnacle Corp. They simultaneously registered a lookalike of <code>pinaclecorp.com</code> to deceive the vendor. Both sides were actively communicating — just with the attacker, not each other. This is email man-in-the-middle, not standard BEC.</p>

  <p><strong>3. Domain Mirroring Is a Deliberate Tactic</strong><br>
  The attacker studied the legitimate vendor's mail infrastructure and replicated it — same MX provider, similar SPF configuration, and identical authentication gaps. This level of preparation indicates reconnaissance happened before the attack, likely weeks or months earlier.</p>

  <p><strong>4. Timing Was Strategic</strong><br>
  The domain was registered several months before the attack. Early registration reduces suspicion from domain age checks and gives the attacker time to warm up the sending reputation.</p>

  <p><strong>5. Thread Hijacking Is the Amplifier</strong><br>
  Entering an existing conversation was the most dangerous element. It bypassed the first-time sender instinct and exploited established context and trust between the parties already in the thread.</p>

  <p><strong>6. Business Process Was the Real Vulnerability</strong><br>
  No technical control failed. The vulnerability was a payment change process that didn't require out-of-band verification. The attacker found the seam between security tooling and business operations — and walked through it.</p>

  <p><strong>7. DMARC p=quarantine Is Not Enough Post-Incident</strong><br>
  For organizations that have experienced impersonation-based fraud, staying at quarantine is hard to justify. Reject is operationally achievable with proper sender inventory management and phased rollout.</p>

  <hr>

  <h2>Lessons Learned</h2>

  <h3>For Security Teams</h3>
  <p>Domain similarity monitoring must cover both directions — inbound lookalikes impersonating vendors, and outbound lookalikes impersonating your own domain to your vendors. This attack ran both simultaneously.</p>
  <p>Run <code>dnstwist</code> against your primary domain quarterly. Domains registered with Levenshtein distance of 1–2 characters that have MX records are your highest-risk lookalikes. Monitor them.</p>
  <p>DMARC aggregate reporting (<code>rua=</code>) is not optional if you're serious about enforcement. Without it, you're enforcing blindly. Enable it before moving to <code>p=reject</code>, and review it monthly.</p>

  <h3>For Detection Engineers</h3>
  <p>Email gateway rules need business context. Generic external sender warnings are noise. Rules that correlate sender domain similarity, domain age, thread participation changes, and financial keywords are signal. Build them.</p>
  <p><code>Message-ID</code> and <code>In-Reply-To</code> headers are forensic gold in BEC investigations. They let you reconstruct exactly when an attacker entered a conversation and what they had access to.</p>

  <h3>For Incident Responders</h3>
  <p>In BEC investigations, start with the headers — not the endpoint. There is no endpoint compromise to find. The attack surface is the email thread itself. Trace participants, verify domains, reconstruct the timeline via Message-ID correlation.</p>
  <p>Out-of-band verification for banking change requests is not a suggestion. It should be a mandatory workflow control, enforced at the process level, not left to individual judgment.</p>

  <h3>For Leaders</h3>
  <p>BEC succeeds not because security failed but because business processes weren't designed with adversarial conditions in mind. Threat-modeling should extend to financial workflows: who can request payment changes, through what channels, with what verification. The security team can detect anomalies — but the process must require verification before action is taken.</p>

  <hr>

  <h2>What Would Have Actually Stopped This</h2>
  <p>Every technical control performed correctly. The attack succeeded anyway. That means the fix is not in the tooling — it is in the controls that were never built.</p>
  <p>These are the five things that would have actually stopped this:</p>

  <p><strong>1. Verified vendor contact inventory</strong><br>
  A maintained list of known, confirmed email domains for active vendors — checked against every inbound financial communication. If <code>meridiapay.com</code> doesn't appear in the vendor registry, the email doesn't reach finance.</p>

  <p><strong>2. Lookalike domain monitoring</strong><br>
  Automated scanning for newly registered domains within Levenshtein distance of known vendor domains. Both attacker domains were registered weeks before the attack. That window is the detection opportunity most organizations never use.</p>

  <p><strong>3. Mandatory out-of-band verification for payment changes</strong><br>
  Any request to change banking details — regardless of how the request arrives, how trusted the thread appears, or how familiar the sender seems — requires confirmation via a known, pre-registered phone number. Not email. Not a number provided in the same message.</p>

  <p><strong>4. Thread-aware anomaly detection</strong><br>
  A SIEM rule that flags new external participants joining an existing financial thread, especially combined with domain age and first-time sender signals. The attacker's entry point was visible in the headers. No rule was watching for it.</p>

  <p><strong>5. Vendor security posture as part of onboarding</strong><br>
  The legitimate vendor had no DMARC. That gap contributed directly to the attack's success. Vendor email authentication posture should be part of third-party risk assessments — not just contracts and certifications.</p>

  <p><strong>None of these require new security tooling. All of them require deliberate process design.</strong></p>

  <hr>

  <h2>The Actual Problem</h2>
  <p>The attack passed every technical gate. Authentication worked. The gateway worked. The SIEM worked. Nothing failed in the way security tools are designed to detect failure.</p>
  <p>The failure was architectural. The question no security control was asking is: <em>should this entity be trusted by this business, in this context, for this request?</em></p>
  <p>Email authentication answers: "Is this message legitimately from the domain it claims?"
  <p>It does not answer: "Is this domain one the organization should trust for financial instructions?"</p>
  <p>That second question requires business context — vendor contact databases, verified contact inventories, out-of-band verification requirements for payment changes, thread-aware anomaly detection.</p>
  <p>Until organizations start threat-modeling their business workflows the same way they threat-model their infrastructure, BEC will remain one of the most effective and least-detected attack patterns in enterprise security.</p>

  <div class="callout">
    <p><strong>The fix isn't better email security tooling. It's building verification into the workflow itself.</strong></p>
  </div>

  <div class="disclaimer">
    This analysis reflects patterns observed in real-world BEC investigations. All identifying details have been anonymized. Certain technical configurations have been generalized to preserve confidentiality.
  </div>

</div>
</body>
</html>
